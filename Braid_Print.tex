\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[headings]{fullpage}
\usepackage{ocamlweb}
\pagestyle{headings}

\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This file has been automatically generated with the command
%% ocamlweb --header --no-index Braid_Print.ml -o Braid_Print.tex 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\typeout{OcamlWeb file Braid_Print.ml}
\ocwmodule{Braid\_Print}
\allowbreak\ocwsection
\label{Braid_Print.ml:0}%
On travaille sur les tresses représentées par les mots de tresses sur 
   l'alphabet dans la présentation d'Artin

\ocweol
\label{Braid_Print.ml:220}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Braid}$\ocweol
\ocwendcode{}\allowbreak\ocwsection
\label{Braid_Print.ml:234}%
Affiche une représentation ASCII de la tresse fournie

\ocweol
\label{Braid_Print.ml:294}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{let}~$\ocwlowerid{ascii}~\ocwlowerid{b}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{print\_vert}~()~=$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{print\_string}~$\ocwstring{"\ocwvspace{}|"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{print\_sigma}~\ocwlowerid{positif}~=~$\ocwkw{function}\ocweol
\ocwindent{4.00em}
$\mid{}~1~\rightarrow{}~\ocwlowerid{print\_string}~$\ocwstring{"\ocwvspace{}\symbol{92}\symbol{92}\ocwvspace{}/"}\ocweol
\ocwindent{4.00em}
$\mid{}~2~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{positif}~$\ocwkw{then}~$\ocwlowerid{print\_string}~$\ocwstring{"\ocwvspace{}\ocwvspace{}/\ocwvspace{}"}\ocweol
\ocwindent{13.00em}
\ocwkw{else}~$\ocwlowerid{print\_string}~$\ocwstring{"\ocwvspace{}\ocwvspace{}\symbol{92}\symbol{92}\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~3~\rightarrow{}~\ocwlowerid{print\_string}~$\ocwstring{"\ocwvspace{}/\ocwvspace{}\symbol{92}\symbol{92}"}~\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{print\_string}~$\ocwstring{"\ocwvspace{}|\ocwvspace{}|"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{aux}~=~$\ocwkw{function}\ocweol
\ocwindent{4.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{print\_newline}~()$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{x}::\ocwlowerid{xs}~\rightarrow{}~$\ocwkw{for}~$\ocwlowerid{l}~=~1~$\ocwkw{to}~4~\ocwkw{do}\ocweol
\ocwindent{11.50em}
\ocwkw{for}~$\ocwlowerid{i}~=~1~$\ocwkw{to}~$(\ocwlowerid{x}-1)~$\ocwkw{do}\ocweol
\ocwindent{12.00em}
$\ocwlowerid{print\_vert}~()$\ocweol
\ocwindent{11.50em}
\ocwkw{done};\ocweol
\ocwindent{11.50em}
$\ocwlowerid{print\_sigma}~(\ocwlowerid{x}>0)~\ocwlowerid{l};$\ocweol
\ocwindent{11.50em}
\ocwkw{for}~$\ocwlowerid{i}~=~\ocwlowerid{x}+2~$\ocwkw{to}~$\ocwlowerid{b.}\ocwlowerid{size}~$\ocwkw{do}\ocweol
\ocwindent{12.00em}
$\ocwlowerid{print\_vert}~()$\ocweol
\ocwindent{11.50em}
\ocwkw{done};\ocweol
\ocwindent{11.50em}
$\ocwlowerid{print\_newline}~();$\ocweol
\ocwindent{9.50em}
\ocwkw{done};\ocweol
\ocwindent{9.50em}
$\ocwlowerid{aux}~\ocwlowerid{xs}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{aux}~\ocwlowerid{b.}\ocwlowerid{word}$\ocweol
\ocwendcode{}\allowbreak\ocwsection
\label{Braid_Print.ml:1097}%
Représentation graphique grâce au module Graphics

\ocweol
\ocwindent{0.00em}
Ratio hauteur du sigma / épaisseur des brins

\ocweol
\label{Braid_Print.ml:1207}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{let}~$\ocwlowerid{ratio}~=~10$\medskip

\ocwendcode{}\ocwindent{0.00em}
Dessine le croisement sigma positif à la position x,y
de hauteur h (coordonnées en bas à gauche de la tresse)

\ocweol
\label{Braid_Print.ml:1344}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{let}~$\ocwlowerid{sigma\_p}~\ocwlowerid{x}~\ocwlowerid{y}~\ocwlowerid{h}~=~$\ocwkw{let}~$\ocwlowerid{e}~=~\ocwlowerid{h}/\ocwlowerid{ratio}~$\ocwkw{in}\ocweol
\ocwindent{10.00em}
\ocwkw{let}~\ocwkw{open}~$\ocwupperid{Graphics}~$\ocwkw{in}\ocweol
\ocwindent{10.00em}
$\ocwlowerid{fill\_poly}~[|~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}/2,~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}-\ocwlowerid{e}+\ocwlowerid{h}/2,~\ocwlowerid{y})~|];$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{set\_color}~\ocwlowerid{white};$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{fill\_poly}~[|~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{e});~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}/2+\ocwlowerid{e},~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y}+\ocwlowerid{h}-\ocwlowerid{e});~$\ocweol
\ocwindent{16.50em}
$(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2-2\times{}\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{h})~|];$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{set\_color}~\ocwlowerid{black};$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{fill\_poly}~[|~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}/2,~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{h})~|]$\medskip

\ocwendcode{}\ocwindent{0.00em}
Dessine le croisement sigma négatif à la position x,y
de hauteur h (coordonnées en bas à gauche de la tresse)

\ocweol
\label{Braid_Print.ml:1999}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{let}~$\ocwlowerid{sigma\_n}~\ocwlowerid{x}~\ocwlowerid{y}~\ocwlowerid{h}~=~$\ocwkw{let}~$\ocwlowerid{e}~=~\ocwlowerid{h}/\ocwlowerid{ratio}~$\ocwkw{in}\ocweol
\ocwindent{10.00em}
\ocwkw{let}~\ocwkw{open}~$\ocwupperid{Graphics}~$\ocwkw{in}\ocweol
\ocwindent{10.00em}
$\ocwlowerid{fill\_poly}~[|~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}/2,~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y}~+~\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}~+~\ocwlowerid{h})~|];$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{set\_color}~\ocwlowerid{white};$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{fill\_poly}~[|~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}~+~\ocwlowerid{h}~-~\ocwlowerid{e});~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}/2+\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y}~+~\ocwlowerid{e});$\ocweol
\ocwindent{16.50em}
$(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2-2\times{}\ocwlowerid{e},~\ocwlowerid{y})~|];$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{set\_color}~\ocwlowerid{black};$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{fill\_poly}~[|~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}/2,~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2,~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y})~|]$\medskip

\ocwendcode{}\ocwindent{0.00em}
Dessine une barre verticale (brin ne se croisant pas)

\ocweol
\label{Braid_Print.ml:2603}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{let}~$\ocwlowerid{vert}~\ocwlowerid{x}~\ocwlowerid{y}~\ocwlowerid{h}~=~$\ocwkw{let}~$\ocwlowerid{e}~=~\ocwlowerid{h}/\ocwlowerid{ratio}~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
\ocwkw{let}~\ocwkw{open}~$\ocwupperid{Graphics}~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
$\ocwlowerid{fill\_poly}~[|~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}/2,~\ocwlowerid{y});~(\ocwlowerid{x}+\ocwlowerid{h}/2,~\ocwlowerid{y}+\ocwlowerid{h});~(\ocwlowerid{x}+\ocwlowerid{h}/2-\ocwlowerid{e},~\ocwlowerid{y}+\ocwlowerid{h})~|]$\medskip

\ocwendcode{}\ocwindent{0.00em}
Affichage graphique de la tresse

\ocweol
\label{Braid_Print.ml:2807}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{let}~$\ocwlowerid{display}~\ocwlowerid{b}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{size}~=~\ocwlowerid{b.}\ocwlowerid{size}~$\ocwkw{and}~$\ocwlowerid{height}~=~\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{b.}\ocwlowerid{word}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{h}~=~($\ocwkw{if}~$\ocwlowerid{height}~=~0~$\ocwkw{then}~60~\ocwkw{else}~$\ocwlowerid{min}~(600/\ocwlowerid{height})~60)~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Graphics.}\ocwlowerid{open\_graph}~($\ocwstring{"\ocwvspace{}"}~\^{}~$(\ocwlowerid{string\_of\_int}~(\ocwlowerid{h}\times{}\ocwlowerid{size}~+~20))~$\^{}~\ocwstring{"x"}~\^{}~$(\ocwlowerid{string\_of\_int}~(\ocwlowerid{h}\times{}\ocwlowerid{height}~+~20)));$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{aux}~\ocwlowerid{x}~\ocwlowerid{y}~=~$\ocwkw{function}\ocweol
\ocwindent{4.00em}
$\mid{}~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{g}::\ocwlowerid{s}~\rightarrow{}~$\ocwkw{for}~$\ocwlowerid{i}~=~0~$\ocwkw{to}~$((\ocwlowerid{abs}~\ocwlowerid{g})-2)~$\ocwkw{do}\ocweol
\ocwindent{11.50em}
$\ocwlowerid{vert}~(\ocwlowerid{x}~+~\ocwlowerid{i}\times{}\ocwlowerid{h})~\ocwlowerid{y}~\ocwlowerid{h}$\ocweol
\ocwindent{9.50em}
\ocwkw{done};\ocweol
\ocwindent{9.50em}
$($\ocwkw{if}~$\ocwlowerid{g}>0~$\ocwkw{then}~$\ocwlowerid{sigma\_p}~$\ocwkw{else}~$\ocwlowerid{sigma\_n})~(\ocwlowerid{x}~+~(((\ocwlowerid{abs}~\ocwlowerid{g})-1)\times{}\ocwlowerid{h}))~\ocwlowerid{y}~\ocwlowerid{h};$\ocweol
\ocwindent{9.50em}
\ocwkw{for}~$\ocwlowerid{i}~=~(\ocwlowerid{abs}~\ocwlowerid{g})+1~$\ocwkw{to}~$\ocwlowerid{size}~$\ocwkw{do}\ocweol
\ocwindent{11.50em}
$\ocwlowerid{vert}~(\ocwlowerid{x}~+~\ocwlowerid{i}\times{}\ocwlowerid{h})~\ocwlowerid{y}~\ocwlowerid{h}$\ocweol
\ocwindent{9.50em}
\ocwkw{done};\ocweol
\ocwindent{9.50em}
$\ocwlowerid{aux}~\ocwlowerid{x}~(\ocwlowerid{y}-\ocwlowerid{h})~\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
$\ocwlowerid{aux}~10~((\ocwlowerid{height}-1)\times{}\ocwlowerid{h}+10)~\ocwlowerid{b.}\ocwlowerid{word};$\ocweol
\ocwindent{2.50em}
$\ocwupperid{Graphics.}\ocwlowerid{read\_key}~();~()$\ocweol
\ocwendcode{}\end{document}
